@model Project
@using Microsoft.AspNetCore.Identity
@inject SignInManager<BTUser> _signInManager

@{
    ViewData["Title"] = "Project Details";
}

<div class="row">
    <div class="col-auto">
        @if(Model.ImageFileData is null)
        {
            <img style="max-height: 100px; max-width: 100px;" src="@Model.ImageFileName" alt="" />
        } else {
            <img style="max-height: 100px; max-width: 100px;" src="data:image/*;base64,@(Convert.ToBase64String(Model.ImageFileData))" />
        }
    </div>
    <div class="col">
        <h1>Project @Model.Name</h1>
        <h6>Priority: @Model.ProjectPriority.Name</h6>
        <a asp-controller="Companies" asp-action="Profile" asp-route-id="@Model.CompanyId">@Model.Company.Name</a>
        <br />
        <a asp-action="Edit" asp-route-id="@Model.Id">Edit</a>
    </div>
</div>
<hr>

<div class="d-flex">
    <h4>Tickets (@Model.Tickets.Count)</h4>

    @if(!_signInManager.IsSignedIn(User))
    {
        <form asp-action="AddTicketToProject">
            <input type="hidden" name="projectId" value="@Model.Id">
            <input type="submit" value="Add Ticket" class="btn btn-sm btn-outline-primary ml-3">
        </form>
    }
</div>

<div class="row">
    @foreach (var ticket in Model.Tickets)
    {
        <div class="col-2 border m-3 p-3">
            <a asp-controller="Tickets" asp-action="Details" asp-route-id="@ticket.Id" class="text-dark text-decoration-none">
                <p>Title: @ticket.Title</p>
                <p>Description: @ticket.Description</p>
                <p>Type: @ticket.TicketType.Name</p>
                <p>Status: @ticket.TicketStatus.Name</p>
                <p>Priority: @ticket.TicketPriority.Name</p>
            </a>
        </div>
    }
</div>
