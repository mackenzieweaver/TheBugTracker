@model Project
@using Microsoft.AspNetCore.Identity
@inject SignInManager<BTUser> _signInManager

@{
    ViewData["Title"] = "Project Details";
}

<div class="row">
    <div class="col">
        @if(Model.ImageFileData is null)
        {
            <img style="max-height: 100px; max-width: 100px;" src="@Model.ImageFileName" alt="" />
        } else {
            <img style="max-height: 100px; max-width: 100px;" src="data:image/*;base64,@(Convert.ToBase64String(Model.ImageFileData))" />
        }
        
        <h1>Project: @Model.Name</h1>
        <h6>ID: @Model.Id</h6>
        <div class="row">
            <div class="col-auto">
                <p>Start: @Model.StartDate.ToString("d")</p>
            </div>
            <div class="col-auto">
                <p>End: @Model.EndDate.ToString("d")</p>
            </div>
        </div>
        <h4>Priority: @Model.ProjectPriority.Name</h4>
        <h5>Archived: @Model.Archived</h5>
        <h6>Company: <a asp-controller="Companies" asp-action="Profile" asp-route-id="@Model.CompanyId">@Model.Company.Name</a></h6>
        <p>@Model.Description</p>
        <a asp-action="Edit" asp-route-id="@Model.Id">Edit Project</a>
        <br />
        @if(Model.Archived){
            <a asp-action="Restore" asp-route-id="@Model.Id">Restore</a>
        } else {
            <a asp-action="Archive" asp-route-id="@Model.Id">Archive</a>
        }
        <br />
        @if(!_signInManager.IsSignedIn(User))
        {
            <form asp-action="AddTicketToProject">
                <input type="hidden" name="projectId" value="@Model.Id">
                <input type="submit" value="Add Ticket" class="btn btn-sm btn-outline-primary ml-3">
            </form>
        }
        @if(Model.Members.Count == 0) {
            <p class="mt-3"><em>No users currently assigned to project</em></p>
        } else {
            <p class="mt-3">Users currently assigned to project</p>
            <ul>
                @foreach (var user in Model.Members)
                {
                    <li>@user.FullName</li>
                }
            </ul>
        }
        <a asp-action="AddUsersToProject" asp-route-id="@Model.Id">
            Assign users
        </a>
    </div>
</div>
